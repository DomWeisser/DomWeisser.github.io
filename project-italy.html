<style>
    /* --- EXISTING STYLES --- */
    .modal-section-title { color: #4CAF50; font-size: 1.2rem; margin-top: 25px; margin-bottom: 10px; border-bottom: 1px solid #333; padding-bottom: 5px; }
    .modal-subsection-title { color: #FFA726; font-size: 0.9rem; margin-top: 15px; margin-bottom: 8px; font-weight: bold; }
    p, li { font-size: 0.85rem; line-height: 1.6; color: #ddd; }
    strong { color: #fff; }

    /* --- NEW IMAGE STYLES --- */
    .img-row {
        display: flex;
        gap: 15px; /* Space between images */
        margin: 20px 0;
        align-items: flex-start;
    }
    .img-col {
        flex: 1; /* Each column takes equal width */
        text-align: center;
    }
    .project-img {
        width: 100%;
        height: auto;
        border-radius: 4px;
        border: 1px solid #444;
        transition: transform 0.2s;
    }
    .project-img:hover {
        transform: scale(1.02);
        border-color: #00ffcc;
    }
    .img-caption {
        font-size: 0.75rem;
        color: #888;
        margin-top: 5px;
        font-style: italic;
    }
</style>

<h3 class="modal-section-title">Project Overview</h3>
<p>
    During my time at Remote Sensing Solutions, I developed an operational forecasting system as part of the EOAgri Twin project for ESA's Destination Earth initiative. The system 
    provides 1-6 month ahead forecasts of key agricultural indicators: Land Surface Temperature (LST), Normalised Difference 
    Vegetation Index (NDVI), and Normalised Difference Infrared Index (NDII), which serve as inputs to a drought forecasting 
    model for agricultural lands globally. Forecasts are generated at <strong>0.01° spatial resolution</strong> (~1km) across 
    Italy and Kenya, providing farm-scale predictions for operational drought monitoring.
</p>

<h3 class="modal-section-title">Core Innovation: Scenario-Based Forecasting</h3>
<p>
    The key innovation of this system is its ability to generate <strong>"what-if"</strong> scenario forecasts that have the ability to answer 
    critical questions for agricultural decision-makers such as:
</p>
<ul>
    <li>What will vegetation health look like in 3 months if we experience drought conditions?</li>
    <li>How will crop stress evolve under extreme wet conditions?</li>
    <li>What is the range of possible outcomes given precipitation uncertainty?</li>
</ul>
<p>This scenario-based approach provides five distinct forecasts per indicator and horizon:</p>
<ul>
    <li><strong>Extreme Dry:</strong> Representing severe drought conditions (5th percentile precipitation)</li>
    <li><strong>Dry:</strong> Below-average precipitation (20th percentile)</li>
    <li><strong>Baseline:</strong> Forecast based on the climatological average precipitation</li>
    <li><strong>Wet:</strong> Above-average precipitation (80th percentile)</li>
    <li><strong>Extreme Wet:</strong> Extreme high precipitation conditions (95th percentile)</li>
</ul>

<div class="img-row">
    <div class="img-col">
        <img src="https://github.com/DomWeisser/DomWeisser.github.io/blob/afdd6324de4c323e367d5dd13fc90c16a5b3dd6b/italy_forecast_1.png" alt="LST Forecast Map" class="project-img">
        <div class="img-caption">Figure 1: LST Forecast June 2024 (Extreme Dry Scenario)</div>
    </div>
    <div class="img-col">
        <img src="italy_forecast_3.png" alt="NDVI Forecast Map" class="project-img">
        <div class="img-caption">Figure 2: LST Forecast June 2024 (Extreme Wet Scenario)</div>
    </div>
</div>

<h3 class="modal-section-title">Methodology</h3>

<h4 class="modal-subsection-title">Model Architecture</h4>
<p>
    The forecasting system employs an ensemble modeling framework combining XGBoost and ElasticNet regression, 
    with optimal weights determined individually for each:
</p>
<ul>
    <li>Geographic region (Italy, Kenya)</li>
    <li>Target variable (LST, NDVI, NDII)</li>
    <li>Forecast horizon (1-6 months ahead)</li>
</ul>
<p>
    This results in 18 specialised ensemble models, each tuned to the specific spatiotemporal characteristics of its prediction task.
</p>

<h4 class="modal-subsection-title">Input Features</h4>
<p>The models utilise two main feature categories:</p>
<ul>
    <li>
        <strong>Historical observations (lagged 1, 2, 3, 6, and 12 months):</strong>
        <ul style="margin-top:5px;">
            <li>Target variable values</li>
            <li>Precipitation totals</li>
            <li>Rolling means and standard deviations</li>
        </ul>
    </li>
    <li>
        <strong>Future precipitation scenarios:</strong>
        <ul style="margin-top:5px;">
            <li>Location-specific monthly climatology (2001-2022)</li>
            <li>Scaled by regional scenario multipliers</li>
        </ul>
    </li>
</ul>

<h4 class="modal-subsection-title">Spatially-Adaptive Scenario Generation</h4>
<p>
    A critical challenge addressed by this methodology is the heterogeneity of climate conditions within each country. 
    For example, northeastern Kenya experiences arid conditions with low precipitation variability, while southwestern Kenya 
    has tropical patterns with high variability. Simply applying uniform scenario definitions nationwide would produce 
    unrealistic scenario forecasts.
</p>
<p><strong>Solution: Regional Scenario Calibration</strong></p>
<ol>
    <li>
        <strong>Stratified spatial sampling:</strong> Each country is divided into 1° × 1° grid cells, with 5 representative 
        training locations selected per cell to ensure geographic coverage while maintaining computational efficiency.
    </li>
    <li>
        <strong>Location-specific distributions:</strong> For each training location, monthly precipitation climatology 
        (2001-2022) is converted to standardised units and modeled using gamma distributions to account for 
        the positive-skewed nature of precipitation data.
    </li>
    <li>
        <strong>Regional scenario multipliers:</strong> Scenario thresholds (5th, 20th, 80th, 95th percentiles) are calculated 
        from the fitted distributions for each location, then averaged within each 1° × 1° region to create regionally-specific 
        scenario multipliers.
    </li>
    <li>
        <strong>Operational application:</strong> During forecasting, precipitation scenarios for any location are computed as:
    </li>
</ol>
<p style="background: rgba(255,255,255,0.1); padding: 10px; border-left: 3px solid #4CAF50; font-family: monospace; font-size: 0.85rem; margin-left: 20px;">
    Precipitation_scenario = Climatology_mean + (Climatology_std × Regional_multiplier)
</p>
<p>
    This approach ensures that an "extreme dry" scenario represents genuinely extreme conditions for both arid northeastern 
    Kenya (e.g., 5mm instead of 15mm) and wet southwestern Kenya (e.g., 80mm instead of 150mm).
</p>

<h4 class="modal-subsection-title">Spatial Resolution and Coverage</h4>
<p>
    Forecasts are generated at <strong>0.01° spatial resolution</strong> (~1km at the equator) exclusively over 
    <strong>agricultural lands</strong>, identified using Copernicus Land Cover classification (cropland, herbaceous, and 
    shrubland classes). This high-resolution, agriculture-focused approach provides actionable information for farm-scale 
    decision-making while maintaining computational feasibility.
</p>

<h4 class="modal-subsection-title">Seasonal Considerations</h4>
<p>
    To optimise model performance for agricultural applications, training data is filtered to the growing season (May-October 
    in Europe), with forecast horizon-dependent adjustments:
</p>
<ul>
    <li><strong>1-month horizon:</strong> April-October targets (excludes early spring)</li>
    <li><strong>3-6 month horizons:</strong> May-October targets (excludes spring transition)</li>
</ul>
<p>
    This seasonal focus improves prediction accuracy during the critical periods for crop development while acknowledging 
    reduced skill during winter dormancy.
</p>

<h3 class="modal-section-title">Model Performance</h3>
<p><strong>Example for LST (3-month ahead, Italy):</strong></p>
<ul>
    <li><strong>Test R²:</strong> 0.83</li>
    <li><strong>Test MAE:</strong> 2.5°C</li>
    <li><strong>Spatial coverage:</strong> 270,000 agricultural pixels</li>
    <li><strong>Scenario consistency:</strong> 85% (predictions maintain expected ordering across scenarios)</li>
</ul>

<h3 class="modal-section-title">Operational Deployment</h3>
<p>
    The system generates monthly operational forecasts as <strong>multi-band GeoTIFF rasters</strong> for seamless integration 
    into the EOAgri Twin platform, providing:
</p>
<ul>
    <li>Five scenario forecasts per indicator</li>
    <li>Spatial uncertainty quantification (±1σ bounds)</li>
    <li>Agricultural land masking</li>
    <li>Standardized CRS and resolution for downstream drought modeling</li>
</ul>
