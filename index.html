<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dominic Weisser | AI & Earth Observation</title>
    
    <script src="//unpkg.com/three@0.148.0/build/three.min.js"></script>
    <script src="//unpkg.com/globe.gl@2.26.4/dist/globe.gl.min.js"></script>

    <style>
        /* --- CSS STYLES --- */
        :root {
            --sidebar-width: 320px;
            --bg-color: #000000;
            --text-color: #ffffff;
            --accent-color: #00ffcc; /* Cyan */
            --glass-bg: rgba(20, 25, 40, 0.9);
        }

        body {
            margin: 0; padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color); color: var(--text-color);
            overflow: hidden;
        }

        #globeViz {
            position: absolute; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 1;
        }

        /* --- DEBUG BOX (Bottom Right) --- */
        #debug-status {
            position: fixed; bottom: 10px; right: 10px;
            background: rgba(0,0,0,0.8); border: 1px solid #333;
            color: #0f0; font-family: monospace; font-size: 10px;
            padding: 5px; z-index: 1000; pointer-events: none;
        }

        /* --- HEADER & UI --- */
        .header-overlay {
            position: absolute; top: 20px; left: 80px; z-index: 5;
            pointer-events: none; text-align: left; max-width: 600px;
        }
        h1 { margin: 0; font-size: 2rem; text-shadow: 0 2px 4px rgba(0,0,0,0.8); }
        .subtitle { color: var(--accent-color); font-size: 1rem; font-weight: 600; text-shadow: 0 2px 4px rgba(0,0,0,0.8); }
        .uni-info { font-size: 0.85rem; color: #ddd; margin-top: 5px; opacity: 0.9; text-shadow: 0 2px 4px rgba(0,0,0,0.8); }

        .menu-btn {
            position: fixed; top: 25px; left: 20px; z-index: 20;
            background: rgba(0, 255, 204, 0.1); color: var(--accent-color); 
            border: 1px solid var(--accent-color); padding: 10px 14px; 
            border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 1.2rem;
        }
        .menu-btn:hover { background: var(--accent-color); color: #000; }

        .sidebar {
            position: fixed; left: 0; top: 0; width: var(--sidebar-width); height: 100%;
            background: var(--glass-bg); backdrop-filter: blur(12px);
            border-right: 1px solid #333; z-index: 15;
            transform: translateX(-100%); transition: transform 0.3s ease-in-out;
            padding: 30px; box-sizing: border-box; padding-top: 80px;
        }
        .sidebar.open { transform: translateX(0); }
        
        .close-sidebar { position: absolute; top: 20px; right: 20px; color: #aaa; cursor: pointer; font-size: 1.5rem; }

        .sidebar-project-link {
            cursor: pointer; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .sidebar-project-link:hover { color: var(--accent-color); }
        .sidebar-project-title { font-weight: bold; display: block; }
        .sidebar-project-loc { font-size: 0.8rem; color: #888; }

        a.btn {
            display: inline-block; background: var(--accent-color); color: #000;
            padding: 8px 16px; text-decoration: none; border-radius: 4px;
            font-size: 0.9rem; font-weight: bold; margin-top: 10px;
        }

        .modal-overlay {
            display: none; position: fixed; z-index: 100; left: 0; top: 0;
            width: 100%; height: 100%; overflow: auto;
            background-color: rgba(0,0,0,0.85); backdrop-filter: blur(5px);
        }
        .modal-content {
            background-color: #151922; margin: 10% auto; padding: 40px;
            border: 1px solid var(--accent-color); width: 80%; max-width: 600px;
            border-radius: 8px; position: relative;
        }
        .close-modal-btn { position: absolute; top: 15px; right: 20px; color: #fff; font-size: 30px; cursor: pointer; }
    </style>
</head>
<body>

    <div id="debug-status">Initializing...</div>

    <div id="globeViz"></div>

    <button class="menu-btn" onclick="toggleSidebar()">☰</button>

    <div class="header-overlay">
        <h1>Dominic Weisser</h1>
        <div class="subtitle">MSc AI for Sustainable Development - UCL</div>
        <div class="uni-info">BSc Maths, OR, Stats & Economics (MORSE) - Warwick</div>
    </div>

    <div class="sidebar" id="mySidebar">
        <div class="close-sidebar" onclick="toggleSidebar()">✕</div>
        <h2 style="color: var(--accent-color);">Projects</h2>
        <div id="project-list-container"></div>
        <div style="margin-top: 40px; border-top: 1px solid #333; padding-top: 20px;">
            <h3>About</h3>
            <p style="font-size: 0.9rem; color: #ccc;">Specializing in Computer Vision and Earth Observation.</p>
            <br>
            <a href="cv.pdf" class="btn" style="width: 100%; text-align: center;">Download CV</a>
        </div>
    </div>

    <div id="projectModal" class="modal-overlay">
        <div class="modal-content">
            <span class="close-modal-btn" onclick="closeModal()">&times;</span>
            <h2 id="modalTitle" style="margin-top:0; color: var(--accent-color);">Title</h2>
            <div id="modalBody" style="line-height: 1.6;">Desc</div>
        </div>
    </div>

    <script>
        // DEBUGGER FUNCTION
        function updateDebug(msg) {
            document.getElementById('debug-status').innerText = msg;
            console.log(msg);
        }

        updateDebug('Scripts Loaded. defining Data...');

        // --- DATA ---
        const myProjects = [
            { lat: -1.2921, lng: 36.8219, name: "Kenya", fullName: "Kenya: Agricultural Mapping", desc: "Mapping smallholder farms using Sentinel-2.", url: "#" },
            { lat: 51.5074, lng: -0.1278, name: "UK", fullName: "UK: Urban Heat Islands", desc: "Analyzing LST in London.", url: "#" },
            { lat: 41.9028, lng: 12.4964, name: "Italy", fullName: "Italy: Heritage Monitoring", desc: "InSAR for heritage sites.", url: "#" },
            { lat: -15.8267, lng: -47.9218, name: "Brazil", fullName: "Brazil: Deforestation", desc: "Amazon forest loss detection.", url: "#" },
            { lat: 42.6977, lng: 23.3219, name: "Bulgaria", fullName: "Bulgaria: Forest Cover", desc: "Landsat change detection.", url: "#" },
            { lat: 48.2082, lng: 16.3738, name: "Austria", fullName: "Austria: Alpine Snow", desc: "MODIS snow line tracking.", url: "#" },
            { lat: 78.2232, lng: 15.6267, name: "Arctic", fullName: "Arctic: Sea Ice", desc: "CryoSat-2 altimetry.", url: "#" }
        ];

        // --- UI FUNCTIONS ---
        function toggleSidebar() { document.getElementById('mySidebar').classList.toggle('open'); }
        const modal = document.getElementById("projectModal");

        function openModal(data) {
            document.getElementById("modalTitle").innerText = data.fullName;
            let content = data.desc;
            if (data.url && data.url !== "#") {
                content += `<br><br><a href="${data.url}" target="_blank" class="btn">Read Full Report &rarr;</a>`;
            }
            document.getElementById("modalBody").innerHTML = content;
            modal.style.display = "block";
            try { world.autoRotate(false); } catch(e){}
        }

        function closeModal() {
            modal.style.display = "none";
            try { world.autoRotate(true); } catch(e){}
        }
        window.onclick = e => { if (e.target == modal) closeModal(); }

        // --- POPULATE SIDEBAR ---
        const listContainer = document.getElementById('project-list-container');
        myProjects.forEach(p => {
            const div = document.createElement('div');
            div.className = 'sidebar-project-link';
            div.innerHTML = `<span class="sidebar-project-title">${p.name}</span><span class="sidebar-project-loc">${p.fullName}</span>`;
            div.onclick = () => { openModal(p); world.pointOfView({ lat: p.lat, lng: p.lng, altitude: 2 }, 1500); };
            listContainer.appendChild(div);
        });

        updateDebug('UI Ready. Initializing Globe...');

        // --- GLOBE INIT ---
        try {
            const world = Globe()
                (document.getElementById('globeViz'))
                .globeImageUrl('https://unpkg.com/three-globe/example/img/earth-blue-marble.jpg')
                .backgroundImageUrl('https://unpkg.com/three-globe/example/img/night-sky.png')
                .atmosphereColor('#3a228a')
                .atmosphereAltitude(0.2)
                .autoRotate(true)
                .autoRotateSpeed(0.5)
                
                // POINTS
                .pointsData(myProjects)
                .pointLat('lat')
                .pointLng('lng')
                .pointColor(() => '#00ffcc')
                .pointAltitude(0.05) 
                .pointRadius(0.9)     
                .pointResolution(24)
                .onPointClick(openModal)

                // LABELS
                .labelsData(myProjects)
                .labelLat('lat')
                .labelLng('lng')
                .labelText('name')
                .labelSize(1.5)
                .labelDotRadius(0.9)
                .labelColor(() => 'rgba(255, 255, 255, 0.9)')
                .labelAltitude(0.06)
                .onLabelClick(openModal);

            updateDebug('Success: Globe Rendering.');
        } catch (error) {
            updateDebug('ERROR: ' + error.message);
        }

    </script>
</body>
</html>
